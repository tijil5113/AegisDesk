<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Secure Login - AegisDesk</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Syne:wght@600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            color-scheme: dark;
            --bg-deep: #030712;
            --bg-mid: #0f172a;
            --bg-card: rgba(15, 23, 42, 0.88);
            --accent: #6366f1;
            --accent-bright: #a78bfa;
            --accent-soft: rgba(99, 102, 241, 0.12);
            --text-primary: #f8fafc;
            --text-muted: rgba(226, 232, 240, 0.6);
            --success: #10b981;
            --border: rgba(148, 163, 184, 0.12);
        }

        * {
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.4; }
            33% { transform: translate(30px, -20px) scale(1.05); opacity: 0.6; }
            66% { transform: translate(-20px, 20px) scale(0.95); opacity: 0.5; }
        }

        @keyframes pulse-glow {
            0%, 100% { opacity: 0.15; filter: blur(80px); }
            50% { opacity: 0.25; filter: blur(100px); }
        }

        @keyframes fade-up {
            from { opacity: 0; transform: translateY(24px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body {
            margin: 0;
            min-height: 100vh;
            background: var(--bg-deep);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 32px;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(ellipse 80% 50% at 20% 40%, rgba(99, 102, 241, 0.18), transparent 50%),
                radial-gradient(ellipse 60% 40% at 80% 20%, rgba(139, 92, 246, 0.12), transparent 45%),
                radial-gradient(ellipse 50% 30% at 50% 80%, rgba(14, 165, 233, 0.08), transparent 40%);
            background-size: 200% 200%;
            animation: gradient-shift 15s ease infinite;
            pointer-events: none;
            z-index: 0;
        }

        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(60px);
            pointer-events: none;
            z-index: 0;
        }
        .orb-1 { width: 320px; height: 320px; background: rgba(99, 102, 241, 0.2); top: 10%; left: 5%; animation: float 12s ease-in-out infinite; }
        .orb-2 { width: 240px; height: 240px; background: rgba(139, 92, 246, 0.15); top: 60%; right: 10%; animation: float 14s ease-in-out infinite 2s; }
        .orb-3 { width: 200px; height: 200px; background: rgba(14, 165, 233, 0.1); bottom: 20%; left: 20%; animation: float 10s ease-in-out infinite 4s; }

        .layout {
            position: relative;
            z-index: 1;
            width: 100%;
            max-width: 520px;
            animation: fade-up 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .brand-block {
            text-align: center;
            margin-bottom: 40px;
            animation: fade-in 0.6s ease-out 0.2s both;
        }

        .brand-logo {
            font-family: 'Syne', sans-serif;
            font-size: clamp(36px, 8vw, 52px);
            font-weight: 800;
            letter-spacing: -0.03em;
            background: linear-gradient(135deg, #fff 0%, rgba(255,255,255,0.85) 50%, rgba(167, 139, 250, 0.9) 100%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
        }

        .brand-tag {
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-top: 8px;
        }

        .card {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 36px;
            border: 1px solid var(--border);
            box-shadow: 
                0 0 0 1px rgba(255,255,255,0.03),
                0 32px 64px -24px rgba(0, 0, 0, 0.5),
                0 0 120px -40px rgba(99, 102, 241, 0.15);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            display: grid;
            gap: 28px;
            animation: fade-up 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.15s both;
        }

        .card-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .card-title h2 {
            margin: 0;
            font-size: 20px;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .card-title .badge {
            font-size: 11px;
            padding: 5px 10px;
            border-radius: 999px;
            background: rgba(16, 185, 129, 0.15);
            color: #34d399;
            font-weight: 600;
            letter-spacing: 0.05em;
        }

        .section {
            display: grid;
            gap: 16px;
            padding: 20px;
            border-radius: 16px;
            background: rgba(0, 0, 0, 0.25);
            border: 1px solid rgba(255,255,255,0.04);
            transition: border-color 0.3s ease, background 0.3s ease;
        }

        .section:focus-within {
            border-color: rgba(99, 102, 241, 0.3);
            background: rgba(99, 102, 241, 0.04);
        }

        .section h3 {
            margin: 0;
            font-size: 15px;
            font-weight: 600;
            letter-spacing: -0.01em;
        }

        .section p {
            margin: 0;
            font-size: 13px;
            color: var(--text-muted);
            line-height: 1.5;
        }

        label {
            font-size: 11px;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--text-muted);
            font-weight: 500;
        }

        input {
            width: 100%;
            padding: 14px 16px;
            border-radius: 12px;
            border: 1px solid rgba(148, 163, 184, 0.15);
            background: rgba(15, 23, 42, 0.6);
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }

        input::placeholder {
            color: rgba(148, 163, 184, 0.4);
        }

        input:hover {
            border-color: rgba(148, 163, 184, 0.3);
        }

        input:focus {
            border-color: rgba(99, 102, 241, 0.6);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.12);
            background: rgba(15, 23, 42, 0.8);
        }

        .split {
            display: grid;
            gap: 14px;
            grid-template-columns: 1fr 1fr;
        }

        @media (max-width: 480px) {
            .split { grid-template-columns: 1fr; }
        }

        .actions {
            display: grid;
            gap: 10px;
        }

        button {
            width: 100%;
            padding: 14px 18px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.02em;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .primary-btn {
            background: linear-gradient(135deg, var(--accent), var(--accent-bright));
            color: white;
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.35);
            position: relative;
            overflow: hidden;
        }

        .primary-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.15), transparent);
            opacity: 0;
            transition: opacity 0.25s ease;
        }

        .primary-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 28px rgba(99, 102, 241, 0.45);
        }

        .primary-btn:hover::before {
            opacity: 1;
        }

        .primary-btn:active {
            transform: translateY(0);
        }

        .ghost-btn {
            background: rgba(148, 163, 184, 0.1);
            color: var(--text-primary);
            border: 1px solid rgba(148, 163, 184, 0.2);
        }

        .ghost-btn:hover {
            background: rgba(148, 163, 184, 0.18);
            border-color: rgba(148, 163, 184, 0.35);
        }

        .status {
            padding: 12px 14px;
            border-radius: 12px;
            font-size: 13px;
            display: none;
            animation: fade-in 0.3s ease;
        }

        .status.success {
            display: block;
            background: rgba(16, 185, 129, 0.12);
            color: #34d399;
            border: 1px solid rgba(16, 185, 129, 0.25);
        }

        .status.error {
            display: block;
            background: rgba(239, 68, 68, 0.12);
            color: #fca5a5;
            border: 1px solid rgba(239, 68, 68, 0.25);
        }

        .session-box {
            display: none;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 16px;
            border-radius: 14px;
            background: rgba(16, 185, 129, 0.08);
            border: 1px solid rgba(16, 185, 129, 0.2);
            animation: fade-in 0.4s ease;
        }

        .session-box.visible {
            display: flex;
        }

        .session-code {
            font-family: "JetBrains Mono", "SF Mono", monospace;
            font-weight: 600;
            font-size: 13px;
            letter-spacing: 0.1em;
            color: #34d399;
        }

        .divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(148, 163, 184, 0.2), transparent);
        }

        .resume-pill {
            display: inline-flex;
            gap: 8px;
            align-items: center;
            font-size: 12px;
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(14, 165, 233, 0.12);
            color: #7dd3fc;
            font-weight: 600;
            width: fit-content;
        }
    </style>
</head>
<body>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>

    <div class="layout">
        <div class="brand-block">
            <h1 class="brand-logo">AegisDesk</h1>
            <div class="brand-tag">Secure Access</div>
        </div>

        <main class="card">
            <div class="card-title">
                <h2>Login Console</h2>
                <span class="badge">Trusted Access</span>
            </div>

            <form id="login-form" class="section">
                <h3>Login with Email + Secret Code</h3>
                <p>Use your approved email and the shared secret code.</p>
                <div class="split">
                    <div>
                        <label for="email">Email ID</label>
                        <input id="email" type="email" autocomplete="username" placeholder="name@citchennai.net" required>
                    </div>
                    <div>
                        <label for="secret">Secret Code</label>
                        <input id="secret" type="password" autocomplete="current-password" placeholder="Enter 6-digit code" required>
                    </div>
                </div>
                <div class="actions">
                    <button class="primary-btn" type="submit">Login & Generate Session ID</button>
                </div>
                <div id="login-status" class="status"></div>
            </form>

            <div class="session-box" id="session-box">
                <div>
                    <div class="fine-print" style="font-size:11px;color:var(--text-muted);margin-bottom:4px;">Your Session ID</div>
                    <div class="session-code" id="session-code">AEGIS-0000-0000</div>
                </div>
                <button class="ghost-btn" id="copy-session" type="button">Copy</button>
            </div>

            <div class="actions" id="continue-actions" style="display:none;">
                <button class="primary-btn" id="continue-btn" type="button">Enter AegisDesk</button>
            </div>

            <div class="divider"></div>

            <form id="resume-form" class="section">
                <div class="resume-pill">Resume with Session ID</div>
                <p>Closed the tab? Enter your Session ID to jump back in.</p>
                <div>
                    <label for="resume-id">Session ID</label>
                    <input id="resume-id" type="text" placeholder="AEGIS-XXXX-XXXX" required>
                </div>
                <div class="actions">
                    <button class="ghost-btn" type="submit">Resume Session</button>
                </div>
                <div id="resume-status" class="status"></div>
            </form>
        </main>
    </div>

    <script>
        const ALLOWED_EMAILS = [
            'mssahana.cse2024@citchennai.net',
            'lakshana.s.cse2024@citchennai.net'
        ];
        const SECRET_CODE = '202007';

        const SESSIONS_KEY = 'aegisdesk_sessions';
        const CURRENT_SESSION_KEY = 'aegisdesk_current_session';
        const LAST_ROUTE_KEY = 'aegisdesk_last_route';
        const SESSION_PENDING_KEY = 'aegisdesk_session_pending';

        const loginForm = document.getElementById('login-form');
        const resumeForm = document.getElementById('resume-form');
        const loginStatus = document.getElementById('login-status');
        const resumeStatus = document.getElementById('resume-status');
        const sessionBox = document.getElementById('session-box');
        const sessionCode = document.getElementById('session-code');
        const copyBtn = document.getElementById('copy-session');
        const continueActions = document.getElementById('continue-actions');
        const continueBtn = document.getElementById('continue-btn');

        function loadSessions() {
            try {
                return JSON.parse(localStorage.getItem(SESSIONS_KEY) || '{}');
            } catch (error) {
                return {};
            }
        }

        function saveSessions(sessions) {
            localStorage.setItem(SESSIONS_KEY, JSON.stringify(sessions));
        }

        function generateSessionId() {
            const bytes = new Uint8Array(6);
            if (window.crypto && window.crypto.getRandomValues) {
                window.crypto.getRandomValues(bytes);
            } else {
                for (let i = 0; i < bytes.length; i += 1) {
                    bytes[i] = Math.floor(Math.random() * 256);
                }
            }
            const hex = Array.from(bytes, (b) => b.toString(16).padStart(2, '0')).join('').toUpperCase();
            return `AEGIS-${hex.slice(0, 4)}-${hex.slice(4, 8)}`;
        }

        function setStatus(el, message, type) {
            el.textContent = message;
            el.className = `status ${type}`;
        }

        function clearStatus(el) {
            el.textContent = '';
            el.className = 'status';
        }

        function setActiveSession(sessionId) {
            const sessions = loadSessions();
            if (!sessions[sessionId]) return false;
            sessions[sessionId].lastActiveAt = Date.now();
            localStorage.setItem(CURRENT_SESSION_KEY, sessionId);
            saveSessions(sessions);
            return true;
        }

        function redirectToDesktop() {
            localStorage.setItem(SESSION_PENDING_KEY, 'false');
            const lastRoute = localStorage.getItem(LAST_ROUTE_KEY) || 'desktop.html';
            window.location.href = lastRoute;
        }

        function showSession(sessionId) {
            sessionCode.textContent = sessionId;
            sessionBox.classList.add('visible');
            continueActions.style.display = 'block';
        }

        loginForm.addEventListener('submit', (event) => {
            event.preventDefault();
            clearStatus(loginStatus);

            const email = document.getElementById('email').value.trim().toLowerCase();
            const secret = document.getElementById('secret').value.trim();

            if (!ALLOWED_EMAILS.includes(email)) {
                setStatus(loginStatus, 'Email ID not authorized for this console.', 'error');
                return;
            }

            if (secret !== SECRET_CODE) {
                setStatus(loginStatus, 'Secret code is incorrect. Try again.', 'error');
                return;
            }

            const sessions = loadSessions();
            const sessionId = generateSessionId();

            sessions[sessionId] = {
                email,
                createdAt: Date.now(),
                lastActiveAt: Date.now()
            };

            saveSessions(sessions);
            localStorage.setItem(CURRENT_SESSION_KEY, sessionId);
            localStorage.setItem(SESSION_PENDING_KEY, 'false');

            setStatus(loginStatus, 'Access granted. Session ID generated.', 'success');
            showSession(sessionId);
        });

        resumeForm.addEventListener('submit', (event) => {
            event.preventDefault();
            clearStatus(resumeStatus);
            const resumeId = document.getElementById('resume-id').value.trim().toUpperCase();

            const sessions = loadSessions();
            if (!sessions[resumeId]) {
                setStatus(resumeStatus, 'Session ID not found. Check and try again.', 'error');
                return;
            }

            localStorage.setItem(CURRENT_SESSION_KEY, resumeId);
            localStorage.setItem(SESSION_PENDING_KEY, 'false');
            sessions[resumeId].lastActiveAt = Date.now();
            saveSessions(sessions);
            setStatus(resumeStatus, 'Session verified. Redirecting...', 'success');
            setTimeout(redirectToDesktop, 500);
        });

        copyBtn.addEventListener('click', () => {
            const value = sessionCode.textContent;
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(value).then(() => {
                    copyBtn.textContent = 'Copied';
                    setTimeout(() => {
                        copyBtn.textContent = 'Copy';
                    }, 1200);
                });
            } else {
                setStatus(loginStatus, 'Copy not supported. Please copy manually.', 'error');
            }
        });

        continueBtn.addEventListener('click', redirectToDesktop);

        (function autoShowActiveSession() {
            const current = localStorage.getItem(CURRENT_SESSION_KEY);
            const sessions = loadSessions();
            const pending = localStorage.getItem(SESSION_PENDING_KEY) === 'true';
            if (current && sessions[current]) {
                if (pending) {
                    setStatus(loginStatus, 'Session ID required to resume. Enter it below.', 'error');
                } else {
                    showSession(current);
                    setStatus(loginStatus, 'Active session detected. Continue when ready.', 'success');
                }
            }
        })();
    </script>
</body>
</html>
